<nav class="navbar navbar-expand-lg navbar-dark bg-primary enhanced-navbar">
    <div class="container">
      <!-- Brand -->
      <a class="navbar-brand fw-bold" routerLink="/">
        <i class="fas fa-comments me-2"></i>DoConnect
      </a>
  
      <!-- Mobile Toggle -->
      <button 
        class="navbar-toggler" 
        type="button" 
        (click)="toggleMenu()"
        [attr.aria-expanded]="!isMenuCollapsed">
        <span class="navbar-toggler-icon"></span>
      </button>
  
      <!-- Navigation -->
      <div class="collapse navbar-collapse" [class.show]="!isMenuCollapsed">
        <!-- Main Navigation -->
        <ul class="navbar-nav me-auto">
          <li class="nav-item" *ngFor="let item of navigationItems">
            <a 
              *ngIf="shouldShowNavItem(item)"
              class="nav-link"
              [routerLink]="item.route"
              [class.active]="isActiveRoute(item.route, item.exact)"
              routerLinkActive="active">
              <i [class]="item.icon + ' me-1'"></i>{{ item.label }}
            </a>
          </li>
        </ul>
  
        <!-- Right Side Navigation -->
        <ul class="navbar-nav ms-auto align-items-center">
          <!-- Theme Toggle -->
          <li class="nav-item d-none d-lg-block">
            <app-theme-toggle></app-theme-toggle>
          </li>
  
          <!-- Authentication -->
          <ng-container *ngIf="!isAuthenticated(); else userMenu">
            <li class="nav-item">
              <a class="nav-link" routerLink="/auth/login">
                <i class="fas fa-sign-in-alt me-1"></i>Login
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" routerLink="/auth/register">
                <i class="fas fa-user-plus me-1"></i>Register
              </a>
            </li>
          </ng-container>
  
          <!-- User Menu-->
          <ng-template #userMenu>
         
            <li class="nav-item dropdown">
              <button
                class="nav-link btn btn-link notification-btn"
                (click)="toggleNotifications()"
                [class.active]="isNotificationsPanelOpen">
                <!-- <i class="fas fa-bell"></i> -->
                <span class="badge bg-danger notification-badge" *ngIf="unreadCount > 0">
                  {{ unreadCount > 99 ? '99+' : unreadCount }}
                </span>
              </button> 
              
              <!-- Notifications Panel -->
               <!-- In your app header component -->
<div class="header-actions">
  <app-notification-dropdown></app-notification-dropdown>
  <!-- other header items -->
</div>




              <!-- <div class="dropdown-menu dropdown-menu-end notifications-panel" 
                   [class.show]="isNotificationsPanelOpen">
                <div class="dropdown-header d-flex justify-content-between align-items-center">
                  <h6 class="mb-0">Notifications</h6>
                  <button class="btn btn-sm btn-outline-secondary" (click)="closeNotifications()">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
                
                <div class="notifications-list" *ngIf="notifications.length > 0; else noNotifications">
                  <a 
                    class="dropdown-item notification-item"
                    *ngFor="let notification of notifications"
                    [class.unread]="!notification.isRead"
                    (click)="markNotificationAsRead(notification)">
                    <div class="d-flex align-items-start">
                      <i [class]="getNotificationIcon(notification.type) + ' ' + getNotificationColor(notification.type) + ' me-2'"></i>
                      <div class="notification-content">
                        <div class="notification-title">{{ notification.title }}</div>
                        <div class="notification-message">{{ notification.message }}</div>
                        <small class="notification-time text-muted">
                          {{ notification.createdAt | timeAgo }}
                        </small>
                      </div>
                    </div>
                  </a>
                </div>
                
                <ng-template #noNotifications>
                  <div class="dropdown-item-text text-center py-4">
                    <i class="fas fa-bell-slash fa-2x text-muted mb-2"></i>
                    <p class="mb-0 text-muted">No notifications yet</p>
                  </div>
                </ng-template>
              </div>
            </li> -->
  
            <!-- User Dropdown -->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle user-dropdown" 
                 href="#" 
                 id="userDropdown" 
                 role="button" 
                 data-bs-toggle="dropdown" 
                 aria-expanded="false">
                <i class="fas fa-user-circle me-1"></i>
                {{ getUserDisplayName() }}
              </a>
              
              <ul class="dropdown-menu dropdown-menu-end user-menu">
                <li *ngFor="let item of userMenuItems">
                  <hr class="dropdown-divider" *ngIf="item.divider">
                  <a 
                    *ngIf="item.route"
                    class="dropdown-item"
                    [class.text-danger]="item.danger"
                    [routerLink]="item.route">
                    <i [class]="item.icon + ' me-2'"></i>{{ item.label }}
                  </a>
                  <button 
                    *ngIf="item.action"
                    class="dropdown-item"
                    [class.text-danger]="item.danger"
                    (click)="handleUserMenuAction(item.action)">
                    <i [class]="item.icon + ' me-2'"></i>{{ item.label }}
                  </button>
                </li>
              </ul>
            </li>
          </ng-template>
        </ul>
      </div>
    </div>
  </nav>